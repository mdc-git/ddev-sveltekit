name: ddev-sveltekit

pre_install_actions: []

project_files:
  - nginx_full/nginx-site.conf
  - sveltekit/hooks.server.js
  - docker-compose.network.yaml

post_install_actions:
  - cp sveltekit/hooks.server.js ../src/hooks.server.js

# post_install_actions:
#   - ddev exec .ddev/viteserve/build-dotenv.sh
#   - |
#     #ddev-nodisplay
#     # cd .ddev
#     if [ -f .allow-upgrade ]; then
#       if grep ask .allow-upgrade >/dev/null ; then
#         read replace
#         if [ "$replace" = "y" ]; then
#           echo "true" >.allow-upgrade
#         else
#           echo "false" >.allow-upgrade
#         fi
#       fi
#     fi
#   - |
#     #ddev-nodisplay
#     # cd .ddev
#     if [ -f .allow-upgrade ]; then
#       if grep "true" .allow-upgrade >/dev/null ; then
#         if [ -f .env ]; then
#           sed -i.bak '/^# start vite/,/^\# end vite/d;' .env
#           cat .env-frag >>.env
#           echo ".env updated to:"
#           cat .env
#         else
#           cp .env-frag .env
#         fi
#         rm .env-frag
#       fi
#     fi



